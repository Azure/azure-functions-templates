{
    "$schema": "<TBD>",
    "contentVersion": "2016-03-04-alpha",
    "variables": {
        "storageConnStringLabel": "$variables_storageConnStringLabel",
        "appSettingsHelp": "$variables_appSettingsHelp",
        "selectConnection": "$variables_selectConnection",
        "parameterName": "$variables_parameterName",
        "paramNameLabel": "$variables_paramNameLabel",
        "paramNameInputHelp": "$variables_paramNameInputHelp",
        "paramNameOutputHelp": "$variables_paramNameOutputHelp",
        "apiHubTableDataSetLabel": "$variables_apiHubTableDataSetLabel",
        "apiHubTableDataSetHelp": "$variables_apiHubTableDataSetHelp",
        "apiHubTableNameLabel": "$variables_apiHubTableNameLabel",
        "apiHubTableHelp": "$variables_apiHubTableHelp",
        "apiHubTableEntityLabel": "$variables_apiHubTableEntityLabel",
        "apiHubTableEntityHelp": "$variables_apiHubTableEntityHelp",
        "apiHubTableConnectionLabel": "$variables_apiHubTableConnectionLabel",
        "apiHubTableConnectionHelp": "$variables_apiHubTableConnectionHelp"
    },
    "bindings": [
        {
            "type": "timerTrigger",
            "displayName": "Timer",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "myTimer",
                    "required": true,
                    "label": "$timerTrigger_name_label",
                    "help": "$timerTrigger_name_help",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "schedule",
                    "value": "string",
                    "defaultValue": "0 * * * * *",
                    "required": true,
                    "label": "$timerTrigger_schedule_label",
                    "help": "$timerTrigger_schedule_help"
                }
            ]
        },
        {
            "type": "eventHubTrigger",
            "displayName": "$eventHubOut_displayName",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "myEventHubMessage",
                    "required": true,
                    "label": "$eventHubOut_name_label",
                    "help": "$eventHubTrigger_name_help",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "myeventhub",
                    "required": true,
                    "label": "$eventHubOut_path_label",
                    "help": "$eventHubTrigger_path_help",
                    "validators": [
                        {
                            "expression": "^[a-z0-9]$|^[a-z0-9][a-z0-9-_.]{0,48}[a-z0-9]$",
                            "errorText": "$eventHubTrigger_path_errorText"
                        }
                    ]
                },
                {
                    "name": "consumerGroup",
                    "value": "string",
                    "defaultValue": "$Default",
                    "required": false,
                    "label": "$eventHubTrigger_consumerGroup_label",
                    "help": "$eventHubTrigger_consumerGroup_help"
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "EventHub",
                    "required": true,
                    "label": "$eventHubOut_connection_label",
                    "help": "$eventHubTrigger_connection_help",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "eventHub",
            "displayName": "$eventHubOut_displayName",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputEventHubMessage",
                    "required": true,
                    "label": "$eventHubOut_name_label",
                    "help": "$eventHubOut_name_help",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "outeventhub",
                    "required": true,
                    "label": "$eventHubOut_path_label",
                    "help": "$eventHubOut_path_help",
                    "validators": [
                        {
                            "expression": "^[a-z0-9]$|^[a-z0-9][a-z0-9-_.]{0,48}[a-z0-9]$",
                            "errorText": "$eventHubOut_path_errorText"
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "EventHub",
                    "required": true,
                    "label": "$eventHubTrigger_connection_label",
                    "help": "$eventHubOut_connection_help",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "queue",
            "displayName": "$queueOut_displayName",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputQueueItem",
                    "required": true,
                    "label": "$queueOut_name_label",
                    "help": "$eventHubOut_name_help",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "queueName",
                    "value": "string",
                    "defaultValue": "outqueue",
                    "required": true,
                    "label": "$queueOut_queueName_label",
                    "help": "$queueOut_queueName_help",
                    "validators": [
                        {
                            "expression": "^[0-9a-z][a-z0-9-]{1,61}[0-9a-z]$",
                            "errorText": "$queueOut_queueName_errorText"
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "queueTrigger",
            "displayName": "Azure Storage Queue",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "myQueueItem",
                    "required": true,
                    "label": "$queueOut_name_label",
                    "help": "$timerTrigger_name_help",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "queueName",
                    "value": "string",
                    "defaultValue": "myqueue",
                    "required": true,
                    "label": "$queueOut_queueName_label",
                    "help": "$queueTrigger_queueName_help",
                    "validators": [
                        {
                            "expression": "^[0-9a-z][a-z0-9-]{1,61}[0-9a-z]$",
                            "errorText": "Your queue name must start and end with a letter or number, and it can contain only lowercase letters, numbers, and the hyphen. The name must be 3 to 63 characters."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "blob",
            "displayName": "Azure Storage Blob",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputBlob",
                    "required": true,
                    "label": "$blob_name_label",
                    "help": "$blob_name_help",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "outcontainer/{rand-guid}",
                    "required": true,
                    "label": "Path",
                    "help": "This is the path within your storage account to which the blob will be written.",
                    "validators": [
                        {
                            "expression": "^[a-z0-9](?:[a-z0-9]|(?:\\-(?!\\-))){1,61}[a-z0-9][\\/](\\S){0,1023}[^\\/]$",
                            "errorText": "Your blob path must be a container name of 3 to 63 characters, followed by a blob name of 1 to 1,024 characters. The blob name can be any combination of characters and can contain a maximum of 254 path segments, which are separated by the forward slash (/)."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "blob",
            "displayName": "Azure Storage Blob",
            "direction": "in",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "inputBlob",
                    "required": true,
                    "label": "Blob parameter name",
                    "help": "This is the name of the parameter in the code for input binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "incontainer/{name}",
                    "required": true,
                    "label": "Path",
                    "help": "This is the path within your storage account from which the blob will be read.",
                    "validators": [
                        {
                            "expression": "^[a-z0-9](?:[a-z0-9]|(?:\\-(?!\\-))){1,61}[a-z0-9][\\/](\\S){0,1023}[^\\/]$",
                            "errorText": "Your blob path must be a container name of 3 to 63 characters, followed by a blob name of 1 to 1,024 characters. The blob name can be any combination of characters and can contain a maximum of 254 path segments, which are separated by the forward slash (/)."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "blobTrigger",
            "displayName": "Azure Storage Blob",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "myBlob",
                    "required": true,
                    "label": "Blob parameter name",
                    "help": "This is the name of the parameter in the code for trigger to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "mycontainer",
                    "required": true,
                    "label": "Path",
                    "help": "This is the path within your storage account that the trigger will monitor.",
                    "validators": [
                        {
                            "expression": "(^[a-z0-9](?:[a-z0-9]|(?:\\-(?!\\-))){1,61}[a-z0-9]$)|(^[a-z0-9](?:[a-z0-9]|(?:\\-(?!\\-))){1,61}[a-z0-9][\\/](\\S){0,1023}[^\\/]$)",
                            "errorText": "Your blob path must be a container name of 3 to 63 characters, followed by a blob name of 1 to 1,024 characters. The blob name can be any combination of characters and can contain a maximum of 254 path segments, which are separated by the forward slash (/)."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "apiHubFile",
            "displayName": "SaaS File",
            "direction": "in",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "input",
                    "required": true,
                    "label": "File parameter name",
                    "help": "This is the name of the parameter in the code for input binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "path/{file}",
                    "required": true,
                    "label": "Path",
                    "help": "The output file path",
                    "validators": []
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "ApiHub",
                    "required": true,
                    "label": "SaaS File connection",
                    "help": "The connection string to your SaaS File connection",
                    "metadata": {
                        "capability": "blob"
                    }
                }
            ]
        },
        {
            "type": "apiHubFile",
            "displayName": "SaaS File",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "output",
                    "required": true,
                    "label": "File parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "path/{file}",
                    "required": true,
                    "label": "Path",
                    "help": "The input file path",
                    "validators": []
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "ApiHub",
                    "required": true,
                    "label": "SaaS File connection",
                    "help": "The connection string to your SaaS File connection",
                    "metadata": {
                        "capability": "blob"
                    }
                }
            ]
        },
        {
            "type": "apiHubFileTrigger",
            "displayName": "SaaS File Trigger",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "trigger",
                    "required": true,
                    "label": "File parameter name",
                    "help": "This is the name of the parameter in the code for trigger to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "path",
                    "value": "string",
                    "defaultValue": "path/{file}",
                    "required": true,
                    "label": "Path",
                    "help": "The path to trigger on. This path must exist.",
                    "validators": []
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "ApiHub",
                    "required": true,
                    "label": "SaaS File connection",
                    "help": "The connection string to your SaaS File connection",
                    "metadata": {
                        "capability": "blob",
                        "excluded": [
                            "googledrive",
                            "azureblob"
                        ]
                    }
                }
            ]
        },
        {
            "type": "apiHubTable",
            "displayName": "SaaS Table",
            "direction": "in",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "input",
                    "required": true,
                    "label": "[variables('paramNameLabel')]",
                    "help": "[variables('paramNameInputHelp')]",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "dataSetName",
                    "value": "string",
                    "defaultValue": "default",
                    "required": false,
                    "label": "[variables('apiHubTableDataSetLabel')]",
                    "help": "[variables('apiHubTableDataSetHelp')]",
                    "validators": []
                },
                {
                    "name": "tableName",
                    "value": "string",
                    "defaultValue": null,
                    "required": false,
                    "label": "[variables('apiHubTableNameLabel')]",
                    "help": "[variables('apiHubTableHelp')]",
                    "validators": []
                },
                {
                    "name": "entityId",
                    "value": "string",
                    "defaultValue": null,
                    "required": false,
                    "label": "[variables('apiHubTableEntityLabel')]",
                    "help": "[variables('apiHubTableEntityHelp')]",
                    "validators": []
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "ApiHub",
                    "required": true,
                    "label": "[variables('apiHubTableConnectionLabel')]",
                    "help": "[variables('apiHubTableConnectionHelp')]",
                    "metadata": {
                        "capability": "tabular"
                    }
                }
            ]
        },
        {
            "type": "apiHubTable",
            "displayName": "SaaS Table",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "output",
                    "required": true,
                    "label": "[variables('paramNameLabel')]",
                    "help": "[variables('paramNameOutputHelp')]",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "dataSetName",
                    "value": "string",
                    "defaultValue": "default",
                    "required": false,
                    "label": "[variables('apiHubTableDataSetLabel')]",
                    "help": "[variables('apiHubTableDataSetHelp')]",
                    "validators": []
                },
                {
                    "name": "tableName",
                    "value": "string",
                    "defaultValue": null,
                    "required": false,
                    "label": "[variables('apiHubTableNameLabel')]",
                    "help": "[variables('apiHubTableHelp')]",
                    "validators": []
                },
                {
                    "name": "entityId",
                    "value": "string",
                    "defaultValue": null,
                    "required": false,
                    "label": "[variables('apiHubTableEntityLabel')]",
                    "help": "[variables('apiHubTableEntityHelp')]",
                    "validators": []
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "ApiHub",
                    "required": true,
                    "label": "[variables('apiHubTableConnectionLabel')]",
                    "help": "[variables('apiHubTableConnectionHelp')]",
                    "metadata": {
                        "capability": "tabular"
                    }
                }
            ]
        },
        {
            "type": "httpTrigger",
            "displayName": "HTTP",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "req",
                    "required": true,
                    "label": "Request parameter name",
                    "help": "This is the name of the parameter in the code for trigger to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "webHookType",
                    "value": "enum",
                    "enum": [
                        {
                            "value": "github",
                            "display": "GitHub"
                        },
                        {
                            "value": "genericJson",
                            "display": "Generic JSON"
                        }
                    ],
                    "label": "Webhook type",
                    "help": "Webhooks allow services to call one another easily."
                },
                {
                    "name": "authLevel",
                    "value": "enum",
                    "enum": [
                        {
                            "value": "function",
                            "display": "Function"
                        },
                        {
                            "value": "anonymous",
                            "display": "Anonymous"
                        },
                        {
                            "value": "admin",
                            "display": "Admin"
                        }
                    ],
                    "label": "Authorization level",
                    "help": "Authorization level controls whether you're using an API key and which key to use; Function uses your function key; Admin uses your master key. The function & master keys are found in your host secrets file. For user-based authentication, go to Function App Settings."
                }
            ],
            "rules": [
                {
                    "name": "mode",
                    "type": "exclusivity",
                    "values": [
                        {
                            "value": "authLevel",
                            "display": "Standard",
                            "hiddenSettings": [
                                "webHookType"
                            ],
                            "shownSettings": [
                                "authLevel"
                            ]
                        },
                        {
                            "value": "webHookType",
                            "display": "Webhook",
                            "hiddenSettings": [
                                "authLevel"
                            ],
                            "shownSettings": [
                                "webHookType"
                            ]
                        }
                    ],
                    "label": "Mode",
                    "help": "This is the mode of the trigger. \"Standard\" means that the request will be standard HTTP with no additional semantics. \"Webhook\" means that the request will be processed according to a specified webhook type."
                }
            ]
        },
        {
            "type": "http",
            "displayName": "HTTP",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "res",
                    "required": true,
                    "label": "Response parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                }
            ]
        },
        {
            "type": "serviceBusTrigger",
            "displayName": "Azure Service Bus",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "mySbMsg",
                    "required": true,
                    "label": "Message parameter name",
                    "help": "This is the name of the parameter in the code for trigger to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "queueName",
                    "value": "string",
                    "defaultValue": "mysbqueue",
                    "required": true,
                    "label": "Queue name",
                    "help": "This is the name of the queue from which the message will be read.",
                    "validators": [
                        {
                            "expression": "^[0-9a-z][a-z0-9_.-]{1,48}[0-9a-z]$",
                            "errorText": "Your queue name must start and end with a letter or number, and it can contain only lowercase letters, numbers, the period, and the hyphen. The name must be 3 to 63 characters."
                        }
                    ]
                },
                {
                    "name": "topicName",
                    "value": "string",
                    "defaultValue": "mysbtopic",
                    "required": true,
                    "label": "Topic name",
                    "help": "This is the name of the topic from which the message will be read.",
                    "validators": [
                        {
                            "expression": "^[0-9a-z][a-z0-9_.-]{1,48}[0-9a-z]$",
                            "errorText": "Your topic name must start and end with a letter or number, and it can contain only lowercase letters, numbers, the period, and the hyphen. The name must be 3 to 63 characters."
                        }
                    ]
                },
                {
                    "name": "subscriptionName",
                    "value": "string",
                    "defaultValue": "mysubscription",
                    "required": true,
                    "label": "Subscription name",
                    "help": "This is the name of the subscription within the topic to bind to.",
                    "validators": [
                        {
                            "expression": "^[0-9a-zA-Z][a-zA-Z0-9_.-]{1,48}[0-9a-zA-Z]$",
                            "errorText": "Your subscription name must start and end with a letter or number, and it can contain only lowercase letters, numbers, the period, and the hyphen. The name must be 3 to 63 characters."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "EventHub",
                    "required": true,
                    "label": "Service Bus connection",
                    "help": "This is the connection string for your service bus. Make sure that it has Listen rights.",
                    "placeholder": "[variables('selectConnection')]"
                },
                {
                    "name": "accessRights",
                    "value": "enum",
                    "enum": [
                        {
                            "value": "Manage",
                            "display": "Manage"
                        },
                        {
                            "value": "Listen",
                            "display": "Listen"
                        }
                    ],
                    "label": "AccessRights",
                    "help": "This is the access rights the client has to the queue or topic subscription."
                }
            ],
            "rules": [
                {
                    "name": "messageType",
                    "type": "exclusivity",
                    "values": [
                        {
                            "value": "queueName",
                            "display": "Service Bus Queue",
                            "hiddenSettings": [
                                "topicName",
                                "subscriptionName"
                            ],
                            "shownSettings": [
                                "queueName"
                            ]
                        },
                        {
                            "value": "topicName",
                            "display": "Service Bus Topic",
                            "hiddenSettings": [
                                "queueName"
                            ],
                            "shownSettings": [
                                "topicName",
                                "subscriptionName"
                            ]
                        }
                    ],
                    "label": "Message type",
                    "help": "This is the type of service bus message. This lets you choose between using Queues or Topics."
                }
            ]
        },
        {
            "type": "serviceBus",
            "displayName": "Azure Service Bus",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputSbMsg",
                    "required": true,
                    "label": "Message parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "queueName",
                    "value": "string",
                    "defaultValue": "outqueue",
                    "required": true,
                    "label": "Queue name",
                    "help": "This is the queue to which the message will be sent.",
                    "validators": [
                        {
                            "expression": "^[0-9a-z][a-z0-9_.-]{1,48}[0-9a-z]$",
                            "errorText": "Your queue name must start and end with a letter or number, and it can contain only lowercase letters, numbers, the period, and the hyphen. The name must be 3 to 63 characters."
                        }
                    ]
                },
                {
                    "name": "topicName",
                    "value": "string",
                    "defaultValue": "outtopic",
                    "required": true,
                    "label": "Topic name",
                    "help": "This is the topic to which the message will be sent.",
                    "validators": [
                        {
                            "expression": "^[0-9a-z][a-z0-9_.-]{1,48}[0-9a-z]$",
                            "errorText": "Your topic name must start and end with a letter or number, and it can contain only lowercase letters, numbers, the period, and the hyphen. The name must be 3 to 63 characters."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "EventHub",
                    "required": true,
                    "label": "Service Bus connection",
                    "help": "This is the connection string for your service bus. Make sure that it has Send rights.",
                    "placeholder": "[variables('selectConnection')]"
                },
                {
                    "name": "accessRights",
                    "value": "enum",
                    "enum": [
                        {
                            "value": "Manage",
                            "display": "Manage"
                        },
                        {
                            "value": "Send",
                            "display": "Send"
                        }
                    ],
                    "label": "AccessRights",
                    "help": "This is the access rights the client has to the queue or topic subscription."
                }
            ],
            "rules": [
                {
                    "name": "messageType",
                    "type": "exclusivity",
                    "values": [
                        {
                            "value": "queueName",
                            "display": "Service Bus Queue",
                            "hiddenSettings": [
                                "topicName"
                            ],
                            "shownSettings": [
                                "queueName"
                            ]
                        },
                        {
                            "value": "topicName",
                            "display": "Service Bus Topic",
                            "hiddenSettings": [
                                "queueName"
                            ],
                            "shownSettings": [
                                "topicName"
                            ]
                        }
                    ],
                    "label": "Message type",
                    "help": "This is the type of service bus message. This lets you choose between using Queues or Topics."
                }
            ]
        },
        {
            "type": "manualTrigger",
            "displayName": "Manual",
            "direction": "trigger",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "input",
                    "required": true,
                    "label": "Parameter name",
                    "help": "This is the name of the parameter in the code for trigger to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                }
            ]
        },
        {
            "type": "table",
            "displayName": "Azure Storage Table",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputTable",
                    "required": true,
                    "label": "Table parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "tableName",
                    "value": "string",
                    "defaultValue": "outTable",
                    "required": true,
                    "label": "Table name",
                    "help": "This is the name of the table within your storage account to which the data will be written.",
                    "validators": [
                        {
                            "expression": "^[A-Za-z][A-Za-z0-9]{2,62}$",
                            "errorText": "Your table name must be an alphanumeric string of 3 to 63 characters. It can’t start with a number."
                        }
                    ]
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "table",
            "displayName": "Azure Storage Table",
            "direction": "in",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "inputTable",
                    "required": true,
                    "label": "Table parameter name",
                    "help": "This is the name of the parameter in the code for input binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "tableName",
                    "value": "string",
                    "defaultValue": "inTable",
                    "required": true,
                    "label": "Table name",
                    "help": "This is the name of the table within your storage account from which the data will be read.",
                    "validators": [
                        {
                            "expression": "^[A-Za-z][A-Za-z0-9]{2,62}$",
                            "errorText": "Your table name must be an alphanumeric string of 3 to 63 characters. It can’t start with a number."
                        }
                    ]
                },
                {
                    "name": "partitionKey",
                    "value": "string",
                    "required": false,
                    "label": "Partition key (optional)",
                    "help": "This is the value of Partition key column of the table. The records with matching Partition key and Row key will be returned. Row key setting must be configured with Partiton key setting."
                },
                {
                    "name": "rowKey",
                    "value": "string",
                    "defaultValue": "",
                    "required": false,
                    "label": "Row key (optional)",
                    "help": "This is the value of Row key column of the table. The record with matching Row key and Partition key will be returned. Partiton key setting must be configured with Row key setting"
                },
                {
                    "name": "take",
                    "value": "int",
                    "required": false,
                    "label": "Maximum number of records to read (optional)",
                    "help": "This is an integer for the number of records. You may receive fewer records than this value based on the contents of the table and the applied filter.This setting is not applicable to a C# function."
                },
                {
                    "name": "filter",
                    "value": "string",
                    "required": false,
                    "label": "Query filter (optional)",
                    "help": "This is an optional query expression used to filter the results of the table query.This setting is not applicable to a C# function."
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "Storage",
                    "required": true,
                    "label": "[variables('storageConnStringLabel')]",
                    "help": "[variables('appSettingsHelp')]",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "documentDB",
            "displayName": "Azure DocumentDB Document",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputDocument",
                    "required": true,
                    "label": "Document parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "databaseName",
                    "value": "string",
                    "defaultValue": "outDatabase",
                    "required": true,
                    "label": "Database name",
                    "help": "This is the name of the database within your DocumentDB account to which data will be written."
                },
                {
                    "name": "collectionName",
                    "value": "string",
                    "defaultValue": "MyCollection",
                    "required": true,
                    "label": "Collection Name",
                    "help": "This is the name of the collection within your database to which data will be written."
                },
                {
                    "name": "createIfNotExists",
                    "value": "boolean",
                    "defaultValue": false,
                    "required": true,
                    "label": "Would you like the DocumentDB database and collection to be created for you?",
                    "help": "When true, your database and collection will be created automatically."
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "DocumentDB",
                    "required": true,
                    "label": "DocumentDB account connection",
                    "help": "This is the connection string for your DocumentDB account.",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "documentDB",
            "displayName": "Azure DocumentDB Document",
            "direction": "in",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "inputDocument",
                    "required": true,
                    "label": "Document parameter name",
                    "help": "This is the name of the parameter in the code for input binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "databaseName",
                    "value": "string",
                    "defaultValue": "inDatabase",
                    "required": true,
                    "label": "Database name",
                    "help": "This is the name of the database within your DocumentDB account from which data will be read."
                },
                {
                    "name": "collectionName",
                    "value": "string",
                    "defaultValue": "MyCollection",
                    "required": true,
                    "label": "Collection Name",
                    "help": "This is the name of the collection within your database from which data will be read."
                },
                {
                    "name": "id",
                    "value": "string",
                    "defaultValue": "{documentId}",
                    "required": true,
                    "label": "Document ID",
                    "help": "This is the ID of the document that will be read."
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "DocumentDB",
                    "required": true,
                    "label": "DocumentDB account connection",
                    "help": "This is the connection string for your DocumentDB account.",
                    "placeholder": "[variables('selectConnection')]"
                }
            ]
        },
        {
            "type": "mobileTable",
            "displayName": "Azure Mobile Table Record",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "outputRecord",
                    "required": true,
                    "label": "Record parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "tableName",
                    "value": "string",
                    "defaultValue": "outTable",
                    "required": true,
                    "label": "Table name",
                    "help": "This is the name of the table within your Mobile App to which data will be written."
                },
                {
                    "name": "connection",
                    "value": "string",
                    "defaultValue": "My_MobileApp_Uri",
                    "required": true,
                    "label": "Mobile App URL lookup",
                    "help": "This is the app setting name that specifies the URL of your Mobile App."
                },
                {
                    "name": "apiKey",
                    "value": "string",
                    "required": false,
                    "label": "API key lookup (optional)",
                    "help": "This is app setting name that specifies the API Key for your Mobile App. <a target='_blank' href='http://go.microsoft.com/fwlink/?LinkId=780568'>More information</a>."
                }
            ]
        },
        {
            "type": "mobileTable",
            "displayName": "Azure Mobile Table Record",
            "direction": "in",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "inputRecord",
                    "required": true,
                    "label": "Record parameter name",
                    "help": "This is the name of the parameter in the code for input binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "tableName",
                    "value": "string",
                    "defaultValue": "inTable",
                    "required": true,
                    "label": "Table name",
                    "help": "This is the name of the table within your Mobile App from which data will be read."
                },
                {
                    "name": "id",
                    "value": "string",
                    "defaultValue": "{itemId}",
                    "required": true,
                    "label": "Record ID",
                    "help": "This is the id for the record to retrieve."
                },
                {
                    "name": "connection",
                    "value": "string",
                    "defaultValue": "My_MobileApp_Uri",
                    "required": true,
                    "label": "Mobile App URL lookup",
                    "help": "This is the app setting name that specifies the URL of your Mobile App."
                },
                {
                    "name": "apiKey",
                    "value": "string",
                    "required": false,
                    "label": "API key lookup (optional)",
                    "help": "This is the app setting name that specifies the API Key for your Mobile App. <a target='_blank' href='http://go.microsoft.com/fwlink/?LinkId=780568'>More information</a>."
                }
            ]
        },
        {
            "type": "notificationHub",
            "displayName": "Azure Notification Hub",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "notification",
                    "required": true,
                    "label": "Notification parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "hubName",
                    "value": "string",
                    "defaultValue": "myNotificationHub",
                    "required": true,
                    "label": "Notification Hub name",
                    "help": "This is the name of the Notification Hub to be used for sending push notifications."
                },
                {
                    "name": "connection",
                    "value": "string",
                    "resource": "ServiceBus",
                    "required": true,
                    "label": "Notification Hubs namespace connection",
                    "help": "This is the connection string for your notification hub namespace.",
                    "placeholder": "[variables('selectConnection')]"
                },
                {
                    "name": "tagExpression",
                    "value": "string",
                    "required": false,
                    "label": "Tag expression (optional)",
                    "help": "Tag expressions enable you to target specific sets of devices/registrations, when sending a push notification through notification hubs. Leave this blank to broadcast to all registered devices <a target='_blank' href='http://go.microsoft.com/fwlink/?LinkId=785094'>More information</a>."
                },
                {
                    "name": "platform",
                    "value": "enum",
                    "enum": [
                        {
                            "value": "",
                            "display": "Template"
                        },
                        {
                            "value": "apns",
                            "display": "Apple (APNS)"
                        },
                        {
                            "value": "adm",
                            "display": "Amazon (ADM)"
                        },
                        {
                            "value": "gcm",
                            "display": "Google (GCM)"
                        },
                        {
                            "value": "wns",
                            "display": "Windows (WNS)"
                        },
                        {
                            "value": "mpns",
                            "display": "Windows Phone (MPNS)"
                        }
                    ],
                    "label": "Notification Platform",
                    "help": "Choose platform to send native notifcations. Select Template to send template notification."
                }
            ]
        },
        {
            "type": "sendGrid",
            "displayName": "SendGrid",
            "direction": "out",
            "settings": [
                {
                    "name": "name",
                    "value": "string",
                    "defaultValue": "message",
                    "required": true,
                    "label": "Message parameter name",
                    "help": "This is the name of the parameter in the code for output binding to bind to.",
                    "validators": [
                        {
                            "expression": "^[a-zA-Z_$][a-zA-Z_$0-9]*$",
                            "errorText": "[variables('parameterName')]"
                        }
                    ]
                },
                {
                    "name": "to",
                    "value": "string",
                    "defaultValue": "",
                    "required": false,
                    "label": "To address",
                    "help": "This is the email address the message should be sent to. Can be of the form 'user@host.com' or 'Display Name <user@host.com>'. If not specified here, the value can be specified in code."
                },
                {
                    "name": "from",
                    "value": "string",
                    "defaultValue": "",
                    "required": false,
                    "label": "From address",
                    "help": "This is the email address the message is sent from. Can be of the form 'user@host.com' or 'Display Name <user@host.com>'. If not specified here, the value can be specified in code."
                },
                {
                    "name": "subject",
                    "value": "string",
                    "defaultValue": "",
                    "required": false,
                    "label": "Message Subject",
                    "help": "This is the subject line to use for the message. If not specified here, the value can be specified in code."
                },
                {
                    "name": "text",
                    "value": "string",
                    "defaultValue": "",
                    "required": false,
                    "label": "Message Text",
                    "help": "This is the text body to use for the message. If not specified here, the value can be specified in code."
                }
            ]
        }
    ]
}