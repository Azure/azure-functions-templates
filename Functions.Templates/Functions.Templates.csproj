<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="PkgInstall" InitialTargets="Clean;dotnetcliCheck;codeformatterCheck;nugetCheck;PortalTemplatesPkg">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />  
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{0EC16A67-C60A-4950-A533-07D8783C88B0}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Functions.Templates</RootNamespace>
    <AssemblyName>Functions.Templates</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <TemplateVersion>1.0.0</TemplateVersion>
  </PropertyGroup>
  <PropertyGroup>
    <PreBuildEvent>
    </PreBuildEvent>
  </PropertyGroup>
  <ItemGroup>
    <None Include="Documentation\activityTrigger.md" />
    <None Include="Documentation\cosmosDBTrigger.md" />
    <None Include="Documentation\eventGridTrigger.md" />
    <None Include="Documentation\GraphWebhookIn.md" />
    <None Include="Documentation\GraphWebhookOut.md" />
    <None Include="Documentation\ioTHubTrigger.md" />
    <None Include="Documentation\orchestrationClientIn.md" />
    <None Include="Documentation\orchestrationTrigger.md" />
    <None Include="Documentation\OutlookOut.md" />
    <None Include="Documentation\Token.md" />
    <None Include="Documentation\OneDriveOut.md" />
    <None Include="Documentation\OneDriveIn.md" />
    <None Include="Documentation\ExcelOut.md" />
    <None Include="Documentation\ExcelIn.md" />
    <None Include="Documentation\GraphWebhookTrigger.md" />
    <None Include="Templates\BlobTrigger-CSharp\BlobTriggerCSharp.cs" />
    <None Include="Templates\BlobTrigger-JavaScript\function.json" />
    <None Include="Templates\BlobTrigger-JavaScript\metadata.json" />
    <None Include="Templates\BlobTrigger-JavaScript\readme.md" />
    <None Include="Templates\BlobTrigger-JavaScript\sample.dat" />
    <None Include="Templates\DurableFunctionsActivity-CSharp\build.config\template.json" />
    <None Include="Templates\DurableFunctionsActivity-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\DurableFunctionsActivity-CSharp\function.json" />
    <None Include="Templates\DurableFunctionsActivity-CSharp\metadata.json" />
    <None Include="Templates\DurableFunctionsActivity-CSharp\sample.dat" />
    <None Include="Templates\DurableFunctionsHttpStart-CSharp\build.config\template.json" />
    <None Include="Templates\DurableFunctionsHttpStart-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\DurableFunctionsHttpStart-CSharp\function.json" />
    <None Include="Templates\DurableFunctionsHttpStart-CSharp\metadata.json" />
    <None Include="Templates\EventGridTrigger-CSharp\EventGridTriggerCSharp.csx" />
    <None Include="Templates\EventGridTrigger-CSharp\function.json" />
    <None Include="Templates\EventGridTrigger-CSharp\metadata.json" />
    <None Include="Templates\EventGridTrigger-CSharp\sample.dat" />
    <None Include="Templates\DurableFunctionsOrchestrator-CSharp\build.config\template.json" />
    <None Include="Templates\DurableFunctionsOrchestrator-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\DurableFunctionsOrchestrator-CSharp\function.json" />
    <None Include="Templates\DurableFunctionsOrchestrator-CSharp\metadata.json" />
    <None Include="Templates\DurableFunctionsOrchestrator-CSharp\sample.dat" />
    <None Include="Templates\EventHubTrigger-CSharp\build.config\template.json" />
    <None Include="Templates\EventHubTrigger-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\EventHubTrigger-CSharp\function.json" />
    <None Include="Templates\EventHubTrigger-CSharp\metadata.json" />
    <None Include="Templates\EventHubTrigger-CSharp\sample.dat" />
    <None Include="Templates\EventHubTrigger-JavaScript\function.json" />
    <None Include="Templates\EventHubTrigger-JavaScript\metadata.json" />
    <None Include="Templates\EventHubTrigger-JavaScript\sample.dat" />
    <None Include="Templates\HttpTrigger-CSharp\HttpTriggerCSharp.cs" />
    <None Include="Templates\HttpTrigger-JavaScript\function.json" />
    <None Include="Templates\HttpTrigger-JavaScript\metadata.json" />
    <None Include="Templates\HttpTrigger-JavaScript\sample.dat" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\run.cs" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\HttpTriggerWithParametersCSharp.cs" />
    <None Include="Templates\OutlookMessageWebhookCreator-CSharp\function.json" />
    <None Include="Templates\OutlookMessageWebhookCreator-CSharp\metadata.json" />
    <None Include="Templates\OutlookMessageWebhookCreator-CSharp\run.csx" />
    <None Include="Templates\OutlookMessageWebhookDeleter-CSharp\function.json" />
    <None Include="Templates\OutlookMessageWebhookDeleter-CSharp\metadata.json" />
    <None Include="Templates\OutlookMessageWebhookDeleter-CSharp\run.csx" />
    <None Include="Templates\OutlookMessageWebhookHandler-CSharp\function.json" />
    <None Include="Templates\OutlookMessageWebhookHandler-CSharp\metadata.json" />
    <None Include="Templates\OutlookMessageWebhookHandler-CSharp\run.csx" />
    <None Include="Templates\OutlookMessageWebhookRefresher-CSharp\function.json" />
    <None Include="Templates\OutlookMessageWebhookRefresher-CSharp\metadata.json" />
    <None Include="Templates\OutlookMessageWebhookRefresher-CSharp\run.csx" />
    <None Include="Templates\ProfilePhotoAPI-CSharp\function.json" />
    <None Include="Templates\ProfilePhotoAPI-CSharp\metadata.json" />
    <None Include="Templates\ProfilePhotoAPI-CSharp\run.csx" />
    <None Include="Templates\ProjectTemplate\build.config\dotnetcli.host.json" />
    <None Include="Templates\ProjectTemplate\build.config\template.json" />
    <None Include="Templates\ProjectTemplate\host.json" />
    <None Include="Templates\ProjectTemplate\local.settings.json" />
    <None Include="Templates\ProjectTemplate\_gitignore" />
    <None Include="Templates\QueueTrigger-CSharp\QueueTriggerCSharp.cs" />
    <None Include="Templates\QueueTrigger-JavaScript\function.json" />
    <None Include="Templates\QueueTrigger-JavaScript\metadata.json" />
    <None Include="Templates\QueueTrigger-JavaScript\readme.md" />
    <None Include="Templates\QueueTrigger-JavaScript\sample.dat" />
    <None Include="Templates\ScheduledMail-CSharp\function.json" />
    <None Include="Templates\ScheduledMail-CSharp\metadata.json" />
    <None Include="Templates\ScheduledMail-CSharp\run.csx" />
    <None Include="Templates\SendGrid-CSharp\function.json" />
    <None Include="Templates\SendGrid-CSharp\metadata.json" />
    <None Include="Templates\SendGrid-CSharp\run.csx" />
    <None Include="Templates\SendGrid-CSharp\sample.dat" />
    <None Include="Templates\SendGrid-JavaScript\function.json" />
    <None Include="Templates\SendGrid-JavaScript\metadata.json" />
    <None Include="Templates\SendGrid-JavaScript\sample.dat" />
    <None Include="Templates\TimerTrigger-CSharp\TimerTriggerCSharp.cs" />
    <None Include=".template.config\template.json" />
    <None Include="Bindings\bindings.json" />
    <None Include="Documentation\apiHubFileIn.md" />
    <None Include="Documentation\apiHubFileOut.md" />
    <None Include="Documentation\apiHubFileTrigger.md" />
    <None Include="Documentation\apiHubTable.md" />
    <None Include="Documentation\apiHubTableOut.md" />
    <None Include="Documentation\blobIn.md" />
    <None Include="Documentation\blobOut.md" />
    <None Include="Documentation\blobTrigger.md" />
    <None Include="Documentation\botOut.md" />
    <None Include="Documentation\cdsIn.md" />
    <None Include="Documentation\documentDBIn.md" />
    <None Include="Documentation\documentDBOut.md" />
    <None Include="Documentation\eventHubOut.md" />
    <None Include="Documentation\eventHubTrigger.md" />
    <None Include="Documentation\httpOut.md" />
    <None Include="Documentation\httpTrigger.md" />
    <None Include="Documentation\manualTrigger.md" />
    <None Include="Documentation\mobileTableIn.md" />
    <None Include="Documentation\mobileTableOut.md" />
    <None Include="Documentation\notificationHubOut.md" />
    <None Include="Documentation\queueOut.md" />
    <None Include="Documentation\queueTrigger.md" />
    <None Include="Documentation\sendGridOut.md" />
    <None Include="Documentation\serviceBusOut.md" />
    <None Include="Documentation\serviceBusTrigger.md" />
    <None Include="Documentation\tableIn.md" />
    <None Include="Documentation\tableOut.md" />
    <None Include="Documentation\timerTrigger.md" />
    <None Include="Documentation\twilioSmsOut.md" />
    <None Include="PortalTemplates.nuspec" />
    <None Include="Templates\BlobTrigger-CSharp\build.config\template.json" />
    <None Include="Templates\BlobTrigger-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\BlobTrigger-CSharp\function.json" />
    <None Include="Templates\BlobTrigger-CSharp\metadata.json" />
    <None Include="Templates\BlobTrigger-CSharp\readme.md" />
    <None Include="Templates\BlobTrigger-CSharp\sample.dat" />
    <None Include="Templates\HttpTrigger-CSharp\build.config\template.json" />
    <None Include="Templates\HttpTrigger-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\HttpTrigger-CSharp\function.json" />
    <None Include="Templates\HttpTrigger-CSharp\metadata.json" />
    <None Include="Templates\HttpTrigger-CSharp\readme.md" />
    <None Include="Templates\HttpTrigger-CSharp\sample.dat" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\build.config\template.json" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\function.json" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\metadata.json" />
    <None Include="Templates\HttpTriggerWithParameters-CSharp\readme.md" />
    <None Include="Templates\QueueTrigger-CSharp\build.config\template.json" />
    <None Include="Templates\QueueTrigger-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\QueueTrigger-CSharp\function.json" />
    <None Include="Templates\QueueTrigger-CSharp\metadata.json" />
    <None Include="Templates\QueueTrigger-CSharp\readme.md" />
    <None Include="Templates\QueueTrigger-CSharp\sample.dat" />
    <None Include="Templates\TimerTrigger-CSharp\build.config\template.json" />
    <None Include="Templates\TimerTrigger-CSharp\build.config\vs-2017.3.host.json" />
    <None Include="Templates\TimerTrigger-CSharp\function.json" />
    <None Include="Templates\TimerTrigger-CSharp\metadata.json" />
    <None Include="Templates\TimerTrigger-CSharp\readme.md" />
    <None Include="Templates\TimerTrigger-CSharp\sample.dat" />
    <None Include="Templates\TimerTrigger-JavaScript\function.json" />
    <None Include="Templates\TimerTrigger-JavaScript\metadata.json" />
    <None Include="Templates\TimerTrigger-JavaScript\readme.md" />
    <None Include="Templates\TimerTrigger-JavaScript\sample.dat" />
    <None Include="VSTemplates.nuspec" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Resources\cs-CZ\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\de-DE\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\es-ES\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\fr-FR\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\hu-HU\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\it-IT\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\ja-JP\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\ko-KR\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\nl-NL\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\pl-PL\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\pt-BR\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\pt-PT\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\qps-ploc\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\ru-RU\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\sv-SE\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\tr-TR\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\zh-CN\Resources\Resources.resx" />
    <EmbeddedResource Include="Resources\zh-TW\Resources\Resources.resx" />
  </ItemGroup>
  <ItemGroup>
    <Content Include="Templates\BlobTrigger-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\BlobTrigger-JavaScript\index.js" />
    <Content Include="Templates\DurableFunctionsActivity-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\DurableFunctionsHttpStart-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\DurableFunctionsOrchestrator-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\EventHubTrigger-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\EventHubTrigger-JavaScript\index.js" />
    <Content Include="Templates\HttpTrigger-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\HttpTrigger-JavaScript\index.js" />
    <Content Include="Templates\HttpTriggerWithParameters-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\ProjectTemplate\Company.FunctionApp.csproj" />
    <Content Include="Templates\QueueTrigger-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\QueueTrigger-JavaScript\index.js" />
    <Content Include="Templates\SendGrid-JavaScript\index.js" />
    <Content Include="Templates\TimerTrigger-CSharp\build.config\vs-2017.3\function_f.png" />
    <Content Include="Templates\TimerTrigger-JavaScript\index.js" />
    <Content Include="Templates\DurableFunctionsActivity-CSharp\DurableFunctionsActivityCSharp.cs" />
    <Content Include="Templates\DurableFunctionsOrchestrator-CSharp\DurableFunctionsOrchestratorCSharp.cs" />
    <Content Include="Templates\EventHubTrigger-CSharp\EventHubTriggerCSharp.cs" />
    <Content Include="Templates\DurableFunctionsHttpStart-CSharp\DurableFunctionsHttpStartCSharp.cs" />
  </ItemGroup>
  <Target Name="Clean" BeforeTargets="PrepareForBuild">
    <RemoveDir Directories=".\bin\Portal" />
    <RemoveDir Directories=".\bin\VS" />
  </Target>
  <Target Name="dotnetcliCheck" BeforeTargets="PrepareForBuild">
    <Error Condition="!Exists('..\tools\cli\dotnet.exe')" Text="Dotnet cli not found in the ..\tools\cli folder, Please execute getTools.ps1 or download and unzip into the ..\tools\cli folder from https://dotnetcli.blob.core.windows.net/dotnet/Sdk/Release/2.0.0/dotnet-dev-win-x86.latest.zip" />
  </Target>
  <Target Name="codeformatterCheck" BeforeTargets="PrepareForBuild">
    <Error Condition="!Exists('..\tools\CodeFormatter\CodeFormatter.exe')" Text="Code Formatter tool not found in the ..\tools folder,Please execute getTools.ps1 or download and unzip into the ..\tools folder from https://github.com/dotnet/codeformatter/Releases/download/v1.0.0-alpha6/CodeFormatter.zip" />
  </Target>
  <Target Name="nugetCheck" BeforeTargets="PrepareForBuild">
    <Error Condition="!Exists('..\tools\nuget.exe')" Text="Nuget.exe not found in the ..\tools folder. Please execute getTools.ps1 or Please download nuget.exe to the ..\tools folder" />
  </Target>
  <Target Name="CreateTemplateConfig" BeforeTargets="PrepareForBuild">
    <Error Condition="!Exists('..\tools\CreateTemplateConfig\CreateTemplateConfig.exe')" Text="CreateTemplateConfig.exe not found in the ..\tools\CreateTemplateConfig folder. Please execute getTools.ps1 or Please download nuget.exe to the ..\tools folder" />
  </Target>
  <Target Name="PortalTemplatesPkg">
    <Exec Command="..\tools\cli\dotnet.exe new -i .\" />
    <Exec Command="..\tools\cli\dotnet.exe new functions -o .\bin\Portal\temp --force" IgnoreExitCode="true" />
    <Exec Command="..\tools\CodeFormatter\CodeFormatter.exe ..\tools\codeFormat.csproj /nocopyright  /rule-:NewLineAbove,ExplicitVisibility,IllegalHeaders,FieldNames,ExplicitThis,BraceNewLine,UsingLocation,UnicodeLiterals,ReadonlyFields /verbose" IgnoreExitCode="true" />
    <Delete Files=".\bin\Portal\Functions.Templates.csproj" />
    <Exec Command="for /R .\bin\Portal\temp\Templates\ %%x in (*.cs) do ren &quot;%%x&quot; *.csx" />
    <Exec Command="..\tools\nuget.exe pack .\bin\Portal\temp\PortalTemplates.nuspec -Version $(TemplateVersion) -OutputDirectory .\bin\Portal\temp\nuget\" />
    <Copy SourceFiles=".\bin\Portal\temp\nuget\Azure.Functions.Ux.Templates.$(TemplateVersion).nupkg" DestinationFiles=".\bin\Portal\Nuget\Azure.Functions.Ux.Templates.$(TemplateVersion).nupkg" />
    <RemoveDir Directories=".\bin\Portal\temp" />
  </Target>
  <Target Name="PkgInstall" DependsOnTargets="PortalTemplatesPkg">
    <Exec Command="..\tools\nuget.exe install Azure.Functions.Ux.Templates -Version $(TemplateVersion) -Source $(MSBuildProjectDirectory)\bin\Portal\Nuget -OutputDirectory .\bin\Portal\Release -ExcludeVersion" />
  </Target>
  <Target Name="TestConfig" DependsOnTargets="CreateTemplateConfig;PkgInstall">
    <Exec Command="..\tools\CreateTemplateConfig\CreateTemplateConfig.exe $(MSBuildProjectDirectory)\bin\Portal\Release\Azure.Functions.Ux.Templates\ $(MSBuildProjectDirectory)\bin\Portal\Test" />
  </Target>
  <Target Name="VisualStudioTemplates">
    <Exec Command="..\tools\cli\dotnet.exe new -i .\" />
    <Exec Command="..\tools\cli\dotnet.exe new functions --portalTemplates false --vsTemplates true -o .\bin\VS\temp --force" IgnoreExitCode="true" />
    <Exec Command="..\tools\CodeFormatter\CodeFormatter.exe ..\tools\codeFormat.csproj /nocopyright  /rule-:NewLineAbove,ExplicitVisibility,IllegalHeaders,FieldNames,ExplicitThis,BraceNewLine,UsingLocation,UnicodeLiterals,ReadonlyFields /verbose" IgnoreExitCode="true" />
    <Delete Files=".\bin\VS\Functions.Templates.csproj" />
    <Exec Condition="'$(TemplateVersion)' != ''" Command="..\tools\nuget.exe pack .\bin\VS\temp\ItemTemplates.nuspec -Version $(TemplateVersion) -OutputDirectory .\bin\VS\Release\" />
    <Exec Condition="'$(TemplateVersion)' != ''" Command="..\tools\nuget.exe pack .\bin\VS\temp\ProjectTemplates.nuspec -Version $(TemplateVersion) -OutputDirectory .\bin\VS\Release\" />
    <RemoveDir Directories=".\bin\VS\temp" />
  </Target>
</Project>